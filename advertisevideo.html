<!DOCTYPE html>
<html>
<head>
  <title>Video Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <style>
    body { font-family: Arial; padding: 2rem; background: #f9f9f9; }
    h2 { text-align: center; }
    form, .video-list { max-width: 600px; margin: 2rem auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px #ccc; }
    input { width: 100%; padding: 10px; margin-bottom: 10px; }
    button { padding: 10px 20px; margin-right: 10px; background: green; color: white; border: none; }
    .video-item { border-bottom: 1px solid #ddd; padding: 10px 0; }
    .video-item small { display: block; margin: 5px 0; }
    .inactive { color: red; }
  </style>
</head>
<body>

  <h2>Video Manager - Grovikto</h2>

  <form onsubmit="addVideo(event)">
    <input type="url" id="videoUrl" placeholder="Video URL (MP4)" required>
    <button type="submit">Add Video</button>
  </form>

  <div class="video-list" id="videoList">
    <h3>Uploaded Videos</h3>
    <div id="videosContainer">Loading...</div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDkZ5j7BDsf6u6f2fphTL0Au6tQ3NDTdIk",
      authDomain: "verdantra-grows.firebaseapp.com",
      projectId: "verdantra-grows",
      storageBucket: "verdantra-grows.appspot.com",
      messagingSenderId: "642225222429",
      appId: "1:642225222429:web:b32000eda4a1195a45a7f4"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function addVideo(e) {
      e.preventDefault();
      const url = document.getElementById("videoUrl").value.trim();
      if (!url) return;

      await db.collection("videos").add({
        videoUrl: url,
        active: true,
        created: firebase.firestore.Timestamp.now()
      });

      document.getElementById("videoUrl").value = "";
      loadVideos();
    }

    async function loadVideos() {
      const container = document.getElementById("videosContainer");
      container.innerHTML = "";

      const snapshot = await db.collection("videos").orderBy("created", "desc").get();
      if (snapshot.empty) {
        container.innerHTML = "<p>No videos added yet.</p>";
        return;
      }

      snapshot.forEach(doc => {
        const data = doc.data();
        const div = document.createElement("div");
        div.className = "video-item";
        div.innerHTML = `
          <video src="${data.videoUrl}" width="100%" muted loop playsinline style="max-height:180px;margin-bottom:8px"></video>
          <small class="${data.active ? '' : 'inactive'}">${data.videoUrl}</small>
          <button onclick="toggleActive('${doc.id}', ${!data.active})">${data.active ? 'Disable' : 'Enable'}</button>
          <button onclick="deleteVideo('${doc.id}')">Delete</button>
        `;
        container.appendChild(div);
      });
    }

    async function toggleActive(id, status) {
      await db.collection("videos").doc(id).update({ active: status });
      loadVideos();
    }

    async function deleteVideo(id) {
      if (confirm("Are you sure you want to delete this video?")) {
        await db.collection("videos").doc(id).delete();
        loadVideos();
      }
    }

    loadVideos();
  </script>

</body>
</html>
